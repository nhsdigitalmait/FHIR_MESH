# Simulator rule definition file for ITK Testbench
# FHIR Messaging simulator config
# Chris Berry

BEGIN RESPONSES
inf_ack_only_10001	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	10001
inf_ack_only_10002	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	10002
inf_ack_only_10003	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	10003
inf_ack_only_10004	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	10004
inf_ack_only_10005	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	10005
inf_ack_only_10006	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	10006
inf_ack_only_10007	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	10007
inf_ack_only_10008	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	10008
inf_ack_only_10009	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	10009
inf_ack_only_20001	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	20001
inf_ack_only_20002	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	20002
inf_ack_only_20003	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	20003
inf_ack_only_20004	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	20004
inf_ack_only_20005	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	20005
inf_ack_only_20006	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	20006
inf_ack_only_20007	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	20007
inf_ack_only_20008	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	20008
inf_ack_only_20009	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	20009
inf_ack_only_20010	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	20010
inf_ack_only_20011	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	20011
inf_ack_only_20012	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	20012
inf_ack_only_20013	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorInfAckOnly		"200 OK"	20013
bus_ack_only_30001	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorBusAckOnly		"200 OK"	30001
bus_ack_only_30002	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorBusAckOnly		"200 OK"	30002
bus_ack_only_30003	class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActorBusAckOnly		"200 OK"	30003
acks_IB001			class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActor				"200 OK"	IB001
acks_IB002			class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActor				"200 OK"	IB002
acks_IB003			class:uk.nhs.digital.mait.tkwx.tk.internalservices.rules.routingactor.MESHFHIRITKRoutingActor				"200 OK"	IB003
do_process	NONE	0
END RESPONSES

BEGIN SUBSTITUTIONS
__BAID_BUNDLE_UUID__ 	uuid
__IAID_BUNDLE_UUID__ 	uuid
__IA_BUNDLE_UUID__ 	uuid
__IA_MESSAGE_HEADER_UUID__ 	uuid
__IA_OPERATION_OUTCOME_UUID__ 	uuid
__BA_BUNDLE_UUID__ 	uuid
__BA_MESSAGE_HEADER_UUID__ 	uuid
__SENDER_UUID__ 	uuid
__BA_OPERATION_OUTCOME_UUID__ 	uuid
__IA_OPERATION_OUTCOME_UUID__ 	uuid
__TIMESTAMP__	ISO8601datetime
__JOBID__ 	uuid
__ERRORID__ 	uuid
__IDENTIFIER__ Literal 9999999999
__REQUEST_UUID__	Xpath //fhir:MessageHeader/fhir:id/@value
__REQUEST_SOURCE_ENDPOINT__ Xpath /fhir:Bundle/fhir:entry/fhir:resource/fhir:MessageHeader/fhir:source/fhir:endpoint/@value
__REQUEST_DEST_ENDPOINT__ Xpath /fhir:Bundle/fhir:entry/fhir:resource/fhir:MessageHeader/fhir:destination/fhir:endpoint/@value
__REQUEST_FOCUS_UUID__ Xpath /fhir:Bundle/fhir:entry/fhir:resource/fhir:Bundle/fhir:id/@value
# added scf Mesh control files are viewed as text not xml test with MeshRulesEngineTest
#SESSION_ID reg_exp mesh_ctl "(?s)^.*From_DTS.(.*)..From_DTS.*$" "$1"
SESSION_ID Xpath mesh_ctl /DTSControl/From_DTS
END SUBSTITUTIONS

#Test Data Lists

######################################################################################################################################################################################
#Test Data List
# BA 30001 List
#'9657702003 9657702011 9657702038 9657702046 9657702054 9657702062 9657702070 9657702089 9657702097 9657702100 9657702119 9657702127 9657702135 9657702143 9657702151'

# BA 30002 List
#'9657702178 9657702186 9657702194 9657702208 9657702216 9657702224 9657702232 9657702240 9657702259 9657702267 9657702275 9657702283 9657702291 9657702305 9657702313'

# BA 30003 List
#'99657702402 9657702410 9657702429 9657702437 9657702445'


#######################################################################################################################################################################################

BEGIN EXPRESSIONS
return_testdata_IB001		mesh_dat	XpathEquals	boolean((//*[local-name()='Patient']/*[local-name()='identifier']/*[local-name()='value'][contains('9657702003 9657702011 9657702038 9657702046 9657702054 9657702062 9657702070 9657702089 9657702097 9657702100 9657702119 9657702127 9657702135 9657702143 9657702151' , @value)])and(//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='InfAckRequested']/*[local-name()='valueBoolean'][@value='true'])) true
return_testdata_30001		mesh_dat	XpathEquals	boolean((//*[local-name()='Patient']/*[local-name()='identifier']/*[local-name()='value'][contains('9657702003 9657702011 9657702038 9657702046 9657702054 9657702062 9657702070 9657702089 9657702097 9657702100 9657702119 9657702127 9657702135 9657702143 9657702151' , @value)])and(//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='InfAckRequested']/*[local-name()='valueBoolean'][@value='false'])) true
return_testdata_IB002		mesh_dat	XpathEquals	boolean((//*[local-name()='Patient']/*[local-name()='identifier']/*[local-name()='value'][contains('9657702178 9657702186 9657702194 9657702208 9657702216 9657702224 9657702232 9657702240 9657702259 9657702267 9657702275 9657702283 9657702291 9657702305 9657702313' , @value)])and(//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='InfAckRequested']/*[local-name()='valueBoolean'][@value='true'])) true
return_testdata_30002		mesh_dat	XpathEquals	boolean((//*[local-name()='Patient']/*[local-name()='identifier']/*[local-name()='value'][contains('9657702178 9657702186 9657702194 9657702208 9657702216 9657702224 9657702232 9657702240 9657702259 9657702267 9657702275 9657702283 9657702291 9657702305 9657702313' , @value)])and(//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='InfAckRequested']/*[local-name()='valueBoolean'][@value='false'])) true
return_testdata_IB003		mesh_dat	XpathEquals	boolean((//*[local-name()='Patient']/*[local-name()='identifier']/*[local-name()='value'][contains('9657702402 9657702410 9657702429 9657702437 9657702445' , @value)])and(//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='InfAckRequested']/*[local-name()='valueBoolean'][@value='true'])) true
return_testdata_30003		mesh_dat	XpathEquals	boolean((//*[local-name()='Patient']/*[local-name()='identifier']/*[local-name()='value'][contains('9657702402 9657702410 9657702429 9657702437 9657702445' , @value)])and(//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='InfAckRequested']/*[local-name()='valueBoolean'][@value='false'])) true
return_infnack_10001		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='10001']) true
return_infnack_10002		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='10002']) true
return_infnack_10003		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='10003']) true
return_infnack_10004		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='10004']) true
return_infnack_10005		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='10005']) true
return_infnack_10006		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='10006']) true
return_infnack_10007		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='10007']) true
return_infnack_10008		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='10008']) true
return_infnack_20001		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='20001']) true
return_infnack_20002		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='20002']) true
return_infnack_20003		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='20003']) true
return_infnack_20004		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='20004']) true
return_infnack_20005		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='20005']) true
return_infnack_20006		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='20006']) true
return_infnack_20007		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='20007']) true
return_infnack_20008		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='20008']) true
return_infnack_20009		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='20009']) true
return_infnack_20010		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='20010']) true
return_infnack_20011		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='20011']) true
return_infnack_20012		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='20012']) true
return_infnack_20013		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='20013']) true
return_busack_30001			mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='30001']) true
return_busnack_30002		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='30002']) true
return_busnack_30003		mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='30003']) true
prod_return_bothack_IB001	mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='IB001']) true
prod_return_bothack_IB002	mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='IB002']) true
prod_return_bothack_IB003	mesh_dat	XpathEquals	boolean(//*[local-name()='Bundle']//*[local-name()='entry']/*[local-name()='resource']/*[local-name()='Practitioner']/*[local-name()='name']/*[local-name()='given'][@value='IB003']) true
prod_return_infackonly		mesh_dat	XpathEquals	boolean((//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='InfAckRequested']/*[local-name()='valueBoolean'][@value='true']) and (//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='BusAckRequested']/*[local-name()='valueBoolean'][@value='false'])) true
prod_return_busackonly		mesh_dat	XpathEquals	boolean((//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='InfAckRequested']/*[local-name()='valueBoolean'][@value='false']) and (//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='BusAckRequested']/*[local-name()='valueBoolean'][@value='true'])) true
prod_return_noack			mesh_dat	XpathEquals	boolean((//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='InfAckRequested']/*[local-name()='valueBoolean'][@value='false']) and (//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='BusAckRequested']/*[local-name()='valueBoolean'][@value='false'])) true
prod_return_bothack			mesh_dat	XpathEquals	boolean((//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='InfAckRequested']/*[local-name()='valueBoolean'][@value='true']) and (//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='BusAckRequested']/*[local-name()='valueBoolean'][@value='true'])) true
prod_return_notsetack		mesh_dat	XpathEquals	boolean((//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='InfAckRequested']/*[local-name()='valueBoolean'][@value='true' or @value='false']) and (//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='BusAckRequested']/*[local-name()='valueBoolean'][@value='true' or @value='false'])) false
incoming_busack_inf			mesh_dat	XpathEquals boolean((//*[local-name()='OperationOutcome']/*[local-name()='issue']/*[local-name()='details']/*[local-name()='coding']/*[local-name()='code'][@value='30001' or @value='30002' or @value='30003']) and (//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='InfAckRequested']/*[local-name()='valueBoolean'][@value='true'])) true
incoming_busack_noinfack	mesh_dat	XpathEquals boolean((//*[local-name()='OperationOutcome']/*[local-name()='issue']/*[local-name()='details']/*[local-name()='coding']/*[local-name()='code'][@value='30001' or @value='30002' or @value='30003']) and (not(//*[local-name()='MessageHeader']/*[local-name()='extension']/*[local-name()='extension'][@url='InfAckRequested']/*[local-name()='valueBoolean'][@value='true']))) true
incoming_infack				mesh_dat	XpathEquals	boolean(//*[local-name()='OperationOutcome']/*[local-name()='issue']/*[local-name()='details']/*[local-name()='coding']/*[local-name()='code'][@value='10001' or @value='10002' or @value='10003' or @value='10004' or @value='10005' or @value='10006' or @value='10007' or @value='10008' or @value='10009' or @value='20001' or @value='20002' or @value='20003' or @value='20004' or @value='20005' or @value='20006' or @value='20007' or @value='20008' or @value='20009' or @value='20010' or @value='20011' or @value='20012' or @value='20013']) true
passthrough	Always
END EXPRESSIONS

#Discharge summary (record artifact)/NO caresetting type specified
BEGIN RULE
ITK003D
IF prod_return_noack then do_process
IF return_testdata_IB001 then acks_IB001
IF return_testdata_30001 then bus_ack_only_30001
IF return_testdata_IB002 then acks_IB002
IF return_testdata_30002 then bus_ack_only_30002
IF return_testdata_IB003 then acks_IB003
IF return_testdata_30003 then bus_ack_only_30003
IF return_infnack_10001 then inf_ack_only_10001
IF return_infnack_10002 then inf_ack_only_10002
IF return_infnack_10003 then inf_ack_only_10003
IF return_infnack_10004 then inf_ack_only_10004
IF return_infnack_10005 then inf_ack_only_10005
IF return_infnack_10006 then inf_ack_only_10006
IF return_infnack_10007 then inf_ack_only_10007
IF return_infnack_10008 then inf_ack_only_10008
IF return_infnack_20001 then inf_ack_only_20001
IF return_infnack_20002 then inf_ack_only_20002
IF return_infnack_20003 then inf_ack_only_20003
IF return_infnack_20004 then inf_ack_only_20004
IF return_infnack_20005 then inf_ack_only_20005
IF return_infnack_20006 then inf_ack_only_20006
IF return_infnack_20007 then inf_ack_only_20007
IF return_infnack_20008 then inf_ack_only_20008
IF return_infnack_20009 then inf_ack_only_20009
IF return_infnack_20010 then inf_ack_only_20010
IF return_infnack_20011 then inf_ack_only_20011
IF return_infnack_20012 then inf_ack_only_20012
IF return_infnack_20013 then inf_ack_only_20013
IF return_busack_30001 then bus_ack_only_30001
IF return_busnack_30002 then bus_ack_only_30002
IF return_busnack_30003 then bus_ack_only_30003
IF prod_return_bothack_IB001 then acks_IB001
IF prod_return_bothack_IB002 then acks_IB002
IF prod_return_bothack_IB003 then acks_IB003
IF prod_return_bothack then acks_IB001
IF prod_return_infackonly then inf_ack_only_20013
IF prod_return_busackonly then bus_ack_only_30001
IF prod_return_notsetack then inf_ack_only_10002
END RULE

#Discharge summary (record artifact)/NO caresetting type specified
BEGIN RULE
ITK004D
IF prod_return_noack then do_process
IF return_testdata_IB001 then acks_IB001
IF return_testdata_30001 then bus_ack_only_30001
IF return_testdata_IB002 then acks_IB002
IF return_testdata_30002 then bus_ack_only_30002
IF return_testdata_IB003 then acks_IB003
IF return_testdata_30003 then bus_ack_only_30003
IF return_infnack_10001 then inf_ack_only_10001
IF return_infnack_10002 then inf_ack_only_10002
IF return_infnack_10003 then inf_ack_only_10003
IF return_infnack_10004 then inf_ack_only_10004
IF return_infnack_10005 then inf_ack_only_10005
IF return_infnack_10006 then inf_ack_only_10006
IF return_infnack_10007 then inf_ack_only_10007
IF return_infnack_10008 then inf_ack_only_10008
IF return_infnack_20001 then inf_ack_only_20001
IF return_infnack_20002 then inf_ack_only_20002
IF return_infnack_20003 then inf_ack_only_20003
IF return_infnack_20004 then inf_ack_only_20004
IF return_infnack_20005 then inf_ack_only_20005
IF return_infnack_20006 then inf_ack_only_20006
IF return_infnack_20007 then inf_ack_only_20007
IF return_infnack_20008 then inf_ack_only_20008
IF return_infnack_20009 then inf_ack_only_20009
IF return_infnack_20010 then inf_ack_only_20010
IF return_infnack_20011 then inf_ack_only_20011
IF return_infnack_20012 then inf_ack_only_20012
IF return_infnack_20013 then inf_ack_only_20013
IF return_busack_30001 then bus_ack_only_30001
IF return_busnack_30002 then bus_ack_only_30002
IF return_busnack_30003 then bus_ack_only_30003
IF prod_return_bothack_IB001 then acks_IB001
IF prod_return_bothack_IB002 then acks_IB002
IF prod_return_bothack_IB003 then acks_IB003
IF prod_return_bothack then acks_IB001
IF prod_return_infackonly then inf_ack_only_20013
IF prod_return_busackonly then bus_ack_only_30001
IF prod_return_notsetack then inf_ack_only_10002
END RULE

#Discharge summary (record artifact)/NO caresetting type specified
BEGIN RULE
ITK005D
IF prod_return_noack then do_process
IF return_testdata_IB001 then acks_IB001
IF return_testdata_30001 then bus_ack_only_30001
IF return_testdata_IB002 then acks_IB002
IF return_testdata_30002 then bus_ack_only_30002
IF return_testdata_IB003 then acks_IB003
IF return_testdata_30003 then bus_ack_only_30003
IF return_infnack_10001 then inf_ack_only_10001
IF return_infnack_10002 then inf_ack_only_10002
IF return_infnack_10003 then inf_ack_only_10003
IF return_infnack_10004 then inf_ack_only_10004
IF return_infnack_10005 then inf_ack_only_10005
IF return_infnack_10006 then inf_ack_only_10006
IF return_infnack_10007 then inf_ack_only_10007
IF return_infnack_10008 then inf_ack_only_10008
IF return_infnack_20001 then inf_ack_only_20001
IF return_infnack_20002 then inf_ack_only_20002
IF return_infnack_20003 then inf_ack_only_20003
IF return_infnack_20004 then inf_ack_only_20004
IF return_infnack_20005 then inf_ack_only_20005
IF return_infnack_20006 then inf_ack_only_20006
IF return_infnack_20007 then inf_ack_only_20007
IF return_infnack_20008 then inf_ack_only_20008
IF return_infnack_20009 then inf_ack_only_20009
IF return_infnack_20010 then inf_ack_only_20010
IF return_infnack_20011 then inf_ack_only_20011
IF return_infnack_20012 then inf_ack_only_20012
IF return_infnack_20013 then inf_ack_only_20013
IF return_busack_30001 then bus_ack_only_30001
IF return_busnack_30002 then bus_ack_only_30002
IF return_busnack_30003 then bus_ack_only_30003
IF prod_return_bothack_IB001 then acks_IB001
IF prod_return_bothack_IB002 then acks_IB002
IF prod_return_bothack_IB003 then acks_IB003
IF prod_return_bothack then acks_IB001
IF prod_return_infackonly then inf_ack_only_20013
IF prod_return_busackonly then bus_ack_only_30001
IF prod_return_notsetack then inf_ack_only_10002
END RULE

#Discharge summary (record artifact)/NO caresetting type specified
BEGIN RULE
ITK006D
IF prod_return_noack then do_process
IF return_testdata_IB001 then acks_IB001
IF return_testdata_30001 then bus_ack_only_30001
IF return_testdata_IB002 then acks_IB002
IF return_testdata_30002 then bus_ack_only_30002
IF return_testdata_IB003 then acks_IB003
IF return_testdata_30003 then bus_ack_only_30003
IF return_infnack_10001 then inf_ack_only_10001
IF return_infnack_10002 then inf_ack_only_10002
IF return_infnack_10003 then inf_ack_only_10003
IF return_infnack_10004 then inf_ack_only_10004
IF return_infnack_10005 then inf_ack_only_10005
IF return_infnack_10006 then inf_ack_only_10006
IF return_infnack_10007 then inf_ack_only_10007
IF return_infnack_10008 then inf_ack_only_10008
IF return_infnack_20001 then inf_ack_only_20001
IF return_infnack_20002 then inf_ack_only_20002
IF return_infnack_20003 then inf_ack_only_20003
IF return_infnack_20004 then inf_ack_only_20004
IF return_infnack_20005 then inf_ack_only_20005
IF return_infnack_20006 then inf_ack_only_20006
IF return_infnack_20007 then inf_ack_only_20007
IF return_infnack_20008 then inf_ack_only_20008
IF return_infnack_20009 then inf_ack_only_20009
IF return_infnack_20010 then inf_ack_only_20010
IF return_infnack_20011 then inf_ack_only_20011
IF return_infnack_20012 then inf_ack_only_20012
IF return_infnack_20013 then inf_ack_only_20013
IF return_busack_30001 then bus_ack_only_30001
IF return_busnack_30002 then bus_ack_only_30002
IF return_busnack_30003 then bus_ack_only_30003
IF prod_return_bothack_IB001 then acks_IB001
IF prod_return_bothack_IB002 then acks_IB002
IF prod_return_bothack_IB003 then acks_IB003
IF prod_return_bothack then acks_IB001
IF prod_return_infackonly then inf_ack_only_20013
IF prod_return_busackonly then bus_ack_only_30001
IF prod_return_notsetack then inf_ack_only_10002
END RULE

BEGIN RULE
ITK008M
IF incoming_busack_noinfack then do_process
IF incoming_busack_inf then inf_ack_only_20013
IF incoming_infack then do_process
END RULE

